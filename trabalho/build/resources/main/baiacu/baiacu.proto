
syntax = "proto3";
package baiacu;
option java_package = "com.proto.baiacu";
option java_multiple_files = true;


message Key {
  string key = 1;
}

message Value {
  int64 version = 2;
  int64 timestamp = 3;
  bytes data = 4;   // o formato disso em java é ByteString
}

message KeyValue {
  Key key = 1;
  Value value =2;
}

message StoreRequest {
  KeyValue keyValue = 1;
}

message StoreResponse {
  string status = 1;  // sucesso ou falha
  KeyValue keyValue = 2; //NULL se a chave foi iserida
}

message ShowRequest {  // esse aqui é o get
  KeyValue keyValue = 1;
}

message ShowResponse {
  string status = 1;
  KeyValue keyValue = 2; // só retorna se existir esse dado
}

message DestroyRequest {
  KeyValue keyValue = 1;
}

message DestroyResponse {
  string status = 1;  //
  KeyValue keyValue = 2; // retorna a chave removida
}

message DestroyByVersionRequest {
  KeyValue keyValue = 1;
}

message DestroyByVersionResponse {
  string status = 1;  //
  KeyValue keyValue = 2; // retorna a chave removida
}

message TestAndSetRequest{
  KeyValue keyValue = 1;

}

message TestAndSetResponse{
  string status = 1;
  KeyValue keyValue = 2;
}

service BaiacuService {
  rpc Store (StoreRequest) returns (StoreResponse) {}
  rpc Show (ShowRequest) returns (ShowResponse) {}
  rpc Destroy (DestroyRequest) returns (DestroyResponse) {}
  rpc DestroyByVersion (DestroyByVersionRequest) returns (DestroyByVersionResponse) {}
  rpc testAndSet (TestAndSetRequest) returns (TestAndSetResponse) {}
}